---
title: "206_Assignment_5"
author: "Tess Hooper"
date: "12/2/2018"
output:
  html_document: default
  word_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

####################################
####################################

## Step 1. Load packages and read in data.
```{r, echo=FALSE, message=FALSE}

library(tidyverse)
library(stargazer)
library(knitr)
library(pwr)
library(plotly)
library(ggrepel)
library(effsize)
library(vcdExtra)
library(dplyr)
library(car)
library(stargazer)

grad_enroll <- read_csv("grad_enroll.csv")
median_salary <- read_csv("median_salary_doc.csv")
phd_field <- read_csv("phD_field.csv")
faculty <- read_csv("faculty_salary.csv")

```



####################################
####################################

Part 1: Male and female graduate enrollment (1967 - 2015)

## Compare trends in total graduate enrollment for males and females (use Totals) in the United States from 1967 - 2015. Describe your results statistically, graphically and in text.

a. Exploratory Data Analysis
- Summary data table with graduate enrollment for males and females, part-time/full-time, private/public universites
- Scatter plots for full-time/part-time and gender, private/public universities and gender 
- Regression line for males and females (we need to do a regression because we need the line of best fit to find residuals in order to make sure our model fits our assumptions - residuals are any point that isn't on the line of best fit )

b. Question: How does enrollment in regards to gender change within these categories over time?


```{r, echo=FALSE, message = FALSE}

### Read in grad_enrollment csv

grad_enroll <- read_csv("grad_enrollment.csv")

### Exploratory scatter plot for total male and female grad enrollment by year

grad_scatter <- ggplot(grad_enroll, aes(x = Year, y = Total_Males, col = "Males")) +
  geom_point()+
  geom_point(aes(x = Year, y = Total_Females, col = "Females"))

grad_scatter # The data looks like a linear model makes sense


### Conduct linear model 

female_lm <- lm(grad_enroll$Total_Females ~ grad_enroll$Year)
female_lm
# intercept = -5895502 (y-intercept)
# year = 30126 (slope)

male_lm <- lm(grad_enroll$Total_Males ~ grad_enroll$Year)
male_lm
# intercept = -17112153 (y-intercept)
# year = 9069 (slope)
# This model shows us that for both males and females, enrollment is increasing each year

plot(male_lm) # data is normally distributed
plot(female_lm) # data is normally distributed 


### Explore model fit and significance

summary(female_lm) 
# b = -5895502
# m = 30126

# y = 30126x - 5895502 (y = salmon imports)
# Correlation coefficeint = 0.9827 (adjusted R-squared = 0.9823)
# p-value = < 2.2e-16
## Our R-squared value shows that there is strong model fit (meaning that using year against enrollment is a good idea)

summary(male_lm)

# Plot data with regression line on graph

grad_graph <- ggplot(grad_enroll, aes(x = Year, y = Total_Males, col = "Males")) +
  geom_smooth(method = lm, se = F, aes(col = "Male")) +
  geom_smooth(aes(x = Year, y = Total_Females, col = "Female"), method = lm, se = F) +
  ylab("Enrollment") +
  ggtitle("Changes in Graduate University Enrollment by Sex (1967-2015)")+
  scale_color_discrete(name = "Gender")+
  theme_classic ()

grad_graph


```


<<<<<<< HEAD











































































































































##Part 2. Shifts in female PhD recipients by field (1985, 2000, and 2015). 
=======
Part 2. Shifts in female PhD recipients by field (1985, 2000, and 2015). 
>>>>>>> b400d8b7001a71f3d0af765920a26a74c22bc5a0

a. Describe if and how there was a shift in PhDs awarded to females in Physical and Earth Sciences, Engineering, Education,
and Humanities & Arts in 1985, 2000, and 2015. 

b. Describe in a graph or table.

c. Describe in text and statistically. 

#Note: several ways to interpret this question: decide which you think is/are most interesting. state which you are asking/answering in your report.

```{r, echo=FALSE, message = FALSE}
# Get the 4 fields and only females.

subject_fphds <- phd_field  %>%
  filter(field == "physical and earth sciences"| field == "Engineering"| field == "Education"| field == "Humanities and arts") %>% 
  filter(sex == "female") %>% 
  mutate(field = case_when(
    field == "physical and earth sciences" ~ "Physical Sciences",
    field == "Engineering" ~ "Engineering",
    field == "Education" ~ "Education",
    field == "Humanities and arts" ~ "Arts & Humanities"
  ))

subject_fphds

peryear <- subject_fphds %>% 
  

#Line graph for female phDs across the fields

females_phd_graph <- ggplot(subject_fphds, aes(x=year, y=number, group=field)) +
  geom_line(aes(color=field))+
  geom_point(aes(color=field))+
  labs(x = "Year", y="Frequency (Female-Awarded PhD Degrees)", title = "Number of PhD Degrees Awarded to Females by Field")+
  scale_x_continuous(breaks = c(1985, 2000, 2015))+
  theme_classic()

females_phd_graph

Year85 <- c(569, 198, 3491, 1392)
Year00 <- c(1022, 838, 4179, 2672)
Year15 <- c(1988, 2301, 3502, 2832)

#85=5650
#00=8711
#15=10,623

chi_females <- rbind(Year85, Year00, Year15)
colnames(chi_females) <- c("Pysical Sciences", "Engineering", "Education", "Arts & Humanities")
```




```{r}
#1. Use chi-squared to explore changes in PhD proportions between fields over time. Are we testing ito see if there is a 

#Null hypothesis (H0): There is no significant association between number of degrees awarded and field of study
#Alternative hypothesis (Ha): There is a significant association between number of degrees awarded and field of study.

x2_test <- chisq.test(chi_females)


x2_test

#interested in showing the changes in proportions of number of degrees between the categories across the 3 years. We also want to show total increase or decrease in number of PhD degrees per category.


###p-value is <0.001. There IS a significant association between number of degrees awarded and field of study. 
### x2(6)= 2073.3, p<0.001 

```






































































































































































































































##Part 3: Male and female salaries for starting postdoctoral and other employment positions (2015).

Compare median salaries for male and female doctorate recipients in 2015. Answer these two questions:

A. Does median salary differ significantly between male and female starting postdoc positions?

B. Does median salary differ significantly between male and female PhD recipients in non-postdoc employment positions?


```{r, , echo=FALSE, message=FALSE}

#Ways to explore the medians: Mann-Whitney U and Wilcoxen Signed Rank
#Mann-Whiteney U is the non paired test

#Explore the Data with histograms

postdoc_hist_male <- ggplot(median_salary, aes(x= postdoc_male)) +
  geom_histogram()

postdoc_hist_male


postdoc_hist_female <- ggplot(median_salary, aes(x = postdoc_female))+
  geom_histogram()

postdoc_hist_female

postdoc_qq_male <- ggplot(median_salary, aes(sample = postdoc_male))+
  geom_qq()

postdoc_qq_male

postdoc_qq_female <- ggplot(median_salary, aes(sample = postdoc_female)) +
  geom_qq()

postdoc_qq_female


#no assupmtion of normality necessary, no outliers 


#Mann-Whitney U test

#H0: The medians will not be signifigantly different between male and female postdoc salaries

#HA: The medians will be signifigantly different between male and female postdoc salaries 

  
  











```










##Part 4. Exploring academic salaries for professors in U.S. colleges.

Develop a model describing faculty salary based on data for faculty sex, rank, years in current position, field, and number of years since doctoral degree was earned.
